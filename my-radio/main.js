!function(){"use strict";const t=document,e=t.createElement.bind(t),i=t.getElementById.bind(t);class l{constructor(){this.load=(({url:t,artist:e,song:i,alt:l})=>fetch(t).then(t=>t.json()).then(t=>{if(!t)return null;let s=this.get(t,e),n=this.get(t,i);if(!s||!n){const e=this.get(t,l),i=(e||"").split(" - ");[s,n]=2===i.length?i:[e,null]}return{title:s,subtitle:n}}).catch(t=>null))}get(t,e){let i=t;for(const t of e.split("."))if(!(i=i[t]))return null;return i}}const s="active",n="titles",a="title",r="subtitle",u="li",h="a",o="span";class c{constructor(t,e,i){this.$audio=t,this.$current=null,this.url=null,this.titleLoader=new l,this.titles=new Map,i.forEach(t=>e.appendChild(this.createItem(t)))}createItem(t){const i=e(u),l=e(h),s=e(o),c=e(o),d=e(o),p=e(o);return s.textContent=t.name,c.className=n,d.className=a,p.className=r,i.appendChild(l),l.appendChild(s),l.appendChild(c),c.appendChild(d),c.appendChild(p),this.titles.set(t.url,{$title:d,$subtitle:p}),l.addEventListener("click",()=>this.onClick(i,t)),i}onClick(t,{url:e,title:i}){if(!e)return;const l=e!==this.url;this.stop(),l&&this.play(t,e,i)}stop(){this.$current&&(this.$current.classList.remove(s),this.$current=null,this.url=null,this.$audio.pause(),this.unloadTitle())}play(t,e,i){const l=this.$audio;t.classList.add(s),this.$current=t,this.url=e,l.src=this.url,l.load(),l.play(),i&&this.loadTitle(e,i)}unloadTitle(){this.titleTimer&&(clearTimeout(this.titleTimer),this.titleTimer=null)}loadTitle(t,e){let i=this.titleTimer;this.titleLoader.load(e).then(l=>{if(i&&i!==this.titleTimer)return;const{$title:s,$subtitle:n}=this.titles.get(t);l=l||{title:null,subtitle:null},s.textContent=l.title,n.textContent=l.subtitle,this.titleTimer=i=setTimeout(()=>this.loadTitle(t,e),5e3)})}}(async()=>{const t=i("audio"),e=i("list"),l=await fetch("data.json"),s=await l.json();new c(t,e,s.stations)})()}();